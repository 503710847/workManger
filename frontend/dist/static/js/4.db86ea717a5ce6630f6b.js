webpackJsonp([4],{"5eyz":function(t,e,a){"use strict";e.c=function(){return Object(r.a)({url:"/api/admin",method:"get"})},e.e=function(t){return Object(r.a)({url:"/api/admin",method:"get",params:{page:t}})},e.d=function(t){return Object(r.a)({url:"/api/admin/"+t,method:"get"})},e.f=function(t,e){return Object(r.a)({url:"/api/admin/"+t+"/reset",method:"post",data:{password:e}})},e.h=function(t){return Object(r.a)({url:"/api/admin/upload",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}})},e.g=function(t,e){return Object(r.a)({url:"/api/admin/"+t,method:"put",params:{name:e.name,role:e.role,avatar:e.avatar},headers:{"Content-Type":"application/x-www-form-urlencoded"}})},e.b=function(t){return Object(r.a)({url:"/api/admin/"+t,method:"delete"})},e.a=function(t){return Object(r.a)({url:"/api/admin",method:"post",data:t})};var r=a("Vo7i")},ftCm:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.avatar-uploader .el-upload {\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\r\n  border-color: #20a0ff;\n}\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 178px;\r\n  height: 178px;\r\n  line-height: 178px;\r\n  text-align: center;\n}\n.avatar {\r\n  width: 178px;\r\n  height: 178px;\r\n  display: block;\n}\n.el-pagination{\r\n  padding: 0;\r\n  margin-top: 20px;\r\n  text-align: right;\n}\r\n",""])},iYVw:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("TIfe"),o=a("5eyz"),i=a("/98u"),n={data:function(){return{imageUrl:"",fileList:[],uploadHeader:{Authorization:"Bearer "+Object(r.a)(),Accept:"application/json, text/plain"},importFileUrl:"/api/admin/upload",tableData:[],dialogFormVisible:!1,resetDialogFormVisible:!1,editDialogFormVisible:!1,resetId:"",uploadId:"",form:{id:"",name:"",email:"",role:"",avatar:""},form2:{psw:"",newpsw:""},current_page:1,path:"http://wmhello.natapp1.cc/api/admin",total:0}},methods:{beforeUpload:function(t){var e=this,a=new FormData;return a.append("photo",t),Object(o.h)(a).then(function(t){var a=t.data.url;e.form.avatar=a,e.imageUrl=i.a.site+a}),!0},fetchData:function(){var t=this;Object(o.c)().then(function(e){var a=e.data;t.tableData=a,t.total=e.meta.total}).catch(function(){})},edit:function(t){var e=this,a=t.id;this.uploadId=a,Object(o.d)(a).then(function(t){var a=t.data;e.form=a,a.avatar?e.imageUrl=i.a.site+a.avatar:e.imageUrl="",e.editDialogFormVisible=!0})},reset:function(t){this.form2={psw:"",newpsw:""},this.resetDialogFormVisible=!0,this.resetId=t.id},submit:function(){var t=this;if(this.form2.psw==this.form2.newpsw&&this.form2.psw){var e=this.form2.psw;Object(o.f)(this.resetId,e).then(function(e){200==e.status_code&&(t.$message.success({message:"恭喜你，重置密码成功"}),t.resetDialogFormVisible=!1)})}else this.$message.error({message:"输入密码为空或两次输入密码不同，请重新输入！"}),this.resetDialogFormVisible=!1},saveData:function(){var t=this;Object(o.g)(this.uploadId,this.form).then(function(e){if(200==e.status_code){var a=t.form.id,r=0;r=t.tableData.findIndex(function(t,e){return t.id==a}),t.tableData.splice(r,1,t.form),t.editDialogFormVisible=!1}}).catch(function(){})},del:function(t){var e=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.id,r=null;r=e.tableData.findIndex(function(t){return t.id==a}),Object(o.b)(a).then(function(t){200==t.status_code&&(e.$message({type:"success",message:"删除成功!"}),e.tableData.splice(r,1))}).catch(function(){})}).catch(function(){})},handleCurrentChange:function(t){var e=this,a=t;this.current_page=a,Object(o.e)(a).then(function(t){var a=t.data;e.tableData=a})}},mounted:function(){this.fetchData()},created:function(){},filters:{roleFilter:function(t){return"admin"==t?"管理员":"编辑者"},avatarFilter:function(t){return i.a.site+t}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:!0}},[a("el-table-column",{attrs:{prop:"id",label:"序号",width:"70"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"email",label:"email"}}),t._v(" "),a("el-table-column",{attrs:{label:"权限",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t._f("roleFilter")(e.row.role)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"头像",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.avatar?a("img",{attrs:{src:t._f("avatarFilter")(e.row.avatar),alt:"",width:"50",height:"50"}}):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{attrs:{content:"编辑",placement:"top"}},[a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-edit-outline"},on:{click:function(a){t.edit(e.row)}}})],1),t._v(" "),a("el-tooltip",{attrs:{content:"重置密码",placement:"top"}},[a("el-button",{attrs:{plain:"",icon:"el-icon-setting",size:"small"},on:{click:function(a){t.reset(e.row)}}})],1),t._v(" "),a("el-tooltip",{attrs:{content:"删除",placement:"top"}},[a("el-button",{attrs:{plain:"",icon:"el-icon-delete",type:"danger",size:"small"},on:{click:function(a){t.del(e.row)}}})],1)]}}])})],1),t._v(" "),a("el-dialog",{attrs:{title:"用户信息",visible:t.editDialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.editDialogFormVisible=e}}},[a("el-form",{attrs:{model:t.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"邮箱"}},[a("el-input",{model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"用户权限"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.role,callback:function(e){t.$set(t.form,"role",e)},expression:"form.role"}},[a("el-option",{attrs:{label:"管理员",value:"admin"}},[t._v("管理员")]),t._v(" "),a("el-option",{attrs:{label:"编辑员",value:"editor"}},[t._v("编辑员")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"用户头像"}},[a("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{drag:"",action:"123",accept:".jpg,.png","before-upload":t.beforeUpload}},[t.form.avatar?a("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("点击上传头像，只能上传jpg/png格式文件。")])])],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.editDialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.saveData()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"密码重置",visible:t.resetDialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.resetDialogFormVisible=e}}},[a("el-form",{attrs:{model:t.form2,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"请输入新密码"}},[a("el-input",{attrs:{type:"password"},model:{value:t.form2.psw,callback:function(e){t.$set(t.form2,"psw",e)},expression:"form2.psw"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"再次确认密码"}},[a("el-input",{attrs:{type:"password"},model:{value:t.form2.newpsw,callback:function(e){t.$set(t.form2,"newpsw",e)},expression:"form2.newpsw"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.resetDialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submit()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-pagination",{attrs:{background:"","current-page":t.current_page,layout:"total, prev, pager, next","page-size":15,total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.current_page=e}}})],1)},staticRenderFns:[]};var s=a("VU/8")(n,l,!1,function(t){a("ybLP")},null,null);e.default=s.exports},ybLP:function(t,e,a){var r=a("ftCm");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a("rjj0")("91bedbfc",r,!0)}});